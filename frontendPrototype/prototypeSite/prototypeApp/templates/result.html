{% extends 'base.html' %}

{% block content %}
    <h1>Results</h1>
    <div class="image-container">
        <canvas id="canvas"></canvas>
    </div>
    <div class="nav-arrows">
    </div>

    <div class="button-container">
        <button id="toggleButton">Toggle Image Mask</button>
        <button id="downloadButton">Download</button>
    </div>

    <script>

        document.addEventListener('DOMContentLoaded', () => {

            const toggleButton = document.querySelector('#toggleButton');
            const downloadButton = document.querySelector('#downloadButton');

            toggleButton.addEventListener('click', () => {
                // TODO: Implement toggle image mask functionality
            });

            downloadButton.addEventListener('click', () => {
                // TODO: Implement download functionality downloading all files
            });

            // ToDo: implement navigation between resulting images with arrows -> toggle function between mask and no mask

            const canvas = document.querySelector('#canvas');
            const ctx = canvas.getContext('2d');

            const image = new Image();
            // get current image url
            let currentImageURL = "{{ picture.image.url }}";

            // Set current image url to source for image
            image.src = currentImageURL;

            // get all image urls
            let imageUrls = [{% for pic in pictures %}"{{ pic.image.url }}"{% if not forloop.last %}, {% endif %}{% endfor %}];

            // store total number of images
            const numImages = imageUrls.length;

            let currentImageIndex;

            const dotSize = 10; // Adjust the size of the dot as needed
            let dotPositions = []; // Array to store dot positions
            let dotColor = '#d50909'; // Default dot color (red)

            // Function keeping the user from accidentally leaving page after annotations
            var dontLeave = function (e) {
                return "Annotations you made may not be saved.";
            }

            window.onbeforeunload = dontLeave;
        });

        // ToDo: move script into web file directory
        // ToDo: try php access
        // ToDo: try letting it run over JS


    </script>

    <style>
        .image-container {
            text-align: center;
        }

        .image-container img {
            padding-top: 20px;
            width: auto;
            height: 400px;
        }

        .button-container {
            text-align: center;
            margin-top: 10px;
        }

        .button-container button {
            margin-right: 10px;
        }

        #toggleButton {
            background-color: #4CAF50FF;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        #downloadButton {
            background-color: #4CAF50FF;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }
    </style>

{% endblock %}
